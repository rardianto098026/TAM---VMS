@using System.Text.RegularExpressions;
@using System.Globalization;
<!DOCTYPE html>
<html lang="en">
<!-- begin::Head -->
<head>
    <!--begin::Base Path (base relative path for assets of this page) -->
    <meta charset="utf-8" />

    @{
        String controllerName = (String)ViewContext.RouteData.Values["Controller"];
        String pageTitle = Regex.Replace(controllerName, "[a-z][A-Z]", m => m.Value[0] + " " + char.ToLower(m.Value[1]));
        TextInfo textInfo = new CultureInfo("en-US", false).TextInfo;
        String pageTitleWithTitleCase = textInfo.ToTitleCase(pageTitle);
    }
    <title>@pageTitleWithTitleCase</title>
    @*<meta name="description" content="VMS Monitoring">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">*@

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link rel="shortcut icon" href="@Url.Content("~/favicon.ico")" />

    <!--begin:: Global Mandatory Vendors -->
    @*<link href="~/vendors/general/perfect-scrollbar/css/perfect-scrollbar.css" rel="stylesheet" type="text/css" />*@
    <!--end:: Global Mandatory Vendors -->
    <!--begin:: Global Optional Vendors -->
    @*<link href="~/vendors/general/tether/dist/css/tether.css" rel="stylesheet" type="text/css" />*@
    @*<link href="~/vendors/general/tether/dist/css/tether.css" rel="stylesheet" type="text/css" />*@
    @* <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"> *@
    <link href="~/vendors/general/bootstrap-select/dist/css/bootstrap-select.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="~/vendors/general/bootstrap-switch/dist/css/bootstrap3/bootstrap-switch.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="~/vendors/general/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="~/vendors/general/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@30&display=swap" rel="stylesheet">
    @*<link href="~/vendors/general/select2/dist/css/select2.css" rel="stylesheet" type="text/css" />*@
    @*<link href="~/vendors/general/animate.css/animate.css" rel="stylesheet" type="text/css" />*@
    @*<link href="~/vendors/general/toastr/build/toastr.css" rel="stylesheet" type="text/css" />*@
    <link href="~/vendors/general/sweetalert2/dist/sweetalert2.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    @*<link href="~/vendors/general/socicon/css/socicon.css" rel="stylesheet" type="text/css" />*@
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="~/vendors/general/fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="~/vendors/custom/vendors/line-awesome/css/line-awesome.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    @*<link href="~/vendors/custom/vendors/flaticon/flaticon.css" rel="stylesheet" type="text/css" />*@
    @*<link href="~/vendors/custom/vendors/flaticon2/flaticon.css" rel="stylesheet" type="text/css" />*@
    @*<link href="~/vendors/general/nouislider/distribute/nouislider.css" rel="stylesheet" type="text/css" />*@
    <link href="~/vendors/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="~/css/custom.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    <link href="~/css/fancybox.css" rel="stylesheet" type="text/css" asp-append-version="true" />

    <!--end:: Global Optional Vendors -->
    <!--begin:: Global Optional Vendors -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Poppins" />
    @*<link href="~/css/style.bundle.css" rel="stylesheet" type="text/css"/>*@
    @*<link href="~/css/site.css" rel="stylesheet" type="text/css"/>*@
    <!--end:: Global Optional Vendors -->
    <link href="~/Content/GlobalStyle.css" rel="stylesheet" type="text/css" asp-append-version="true" />
    @*@Html.Partial("Styles/_Common")*@
    <partial name="Styles/_Common" />
    @RenderSection("styles", false)

    <!-- JQUERY & KENDO CORE SCRIPT SECTION -->
    <script src="~/Content/theme/Metronic/global/plugins/jquery.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/jquery-migrate-1.4.1.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/Kendo/kendo.custom.min.js" asp-append-version="true"></script>
    <script src="~/js/jquery.number.js" asp-append-version="true"></script>
    <script src="~/vendors/kendo.all.min.js" asp-append-version="true"></script>
    @*<script src="~/lib/kendo/js/kendo.upload.min.js" asp-append-version="true"></script>*@
    <script src="~/vendors/Kendo/kendo.upload.min.js" asp-append-version="true"></script>
    @*<script src="~/lib/kendo/js/kendo.calendar.min.js"></script>*@
    @*<script src="~/lib/kendo/js/kendo.timezones.min.js"></script>*@

</head>
<!-- end::Head -->
<!-- begin::Body -->
<body class="page-container-bg-solid page-header-fixed page-sidebar-closed-hide-logo page-md" id="wrapToggle">
    <!-- PAGE HEADER SECTION -->
    <partial name="_Header" />
    <!-- begin:: Toolbar -->
    @RenderSection("toolbar", false)
    <!-- end:: Toolbar -->
    <!-- begin: Modal Change Password-->
    <div id="ChangePWModal" class="modal fade bs-modal-lg" data-backdrop="static" abindex="-1" role="dialog" aria-hidden="true" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Change Password</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                </div>
                <div class="modal-body">
                    <form id="ChangePWForm">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Current Password<span class="required">*</span></label>
                                        <input type="password" id="CurrentPW" name="CurrentPW" class="form-control" required />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>New Password<span class="required">*</span></label>
                                        <input type="password" id="NewPW" name="NewPW" class="form-control" required />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Confirm New Password<span class="required">*</span></label>
                                        <input type="password" id="ConfirmNewPW" name="ConfirmNewPW" class="form-control" required/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-info btn-sm" id="btnSaveChangePW">Save</button>
                        <button type="button" class="btn btn-sm btn-outline-brand btn-square" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end: Modal Change Password-->
    <!-- CONTENT SECTION -->
    <div class="page-container">
        <div class="page-sidebar-wrapper">
            <div class="page-sidebar navbar-collapse collapse">
                @*<div class="menu-toggler sidebar-toggler">
                        <img src="~/img/single-sidebar-toggle-grey.png" style="margin-top:10px; display: block; margin-left: auto; margin-right: auto; width:40%; height:5px;" class="center" />
                    </div>
                    <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse"> </a>*@
                @TAM.VMS.Infrastructure.Helper.MenuHelpers.Sidebar()
            </div>
        </div>
        <div class="page-content-wrapper">
            <div class="page-content">
                @RenderBody()
            </div>
        </div>
    </div>
    <!-- PAGE FOOTER SECTION -->
    <partial name="_Footer" />
    <script>
        jQuery["postv2"] = function (url, data, callback) {
            // shift arguments if data argument was omitted
            if (jQuery.isFunction(data)) {
                callback = data;
                data = undefined;
            }

            var contentType = "application/x-www-form-urlencoded; charset=UTF-8";
            if (isJson(data)) {
                contentType = "application/json; charset=utf-8";
            }

            var data = jQuery.ajax({
                url: url,
                type: "POST",
                contentType: contentType,
                data: data,
                success: callback
            });
            return data;
        };

        function isJson(str) {
            try {
                JSON.parse(str);
            } catch (e) {
                return false;
            }
            return true;
        }
    </script>
    <script src="~/vendors/general/popper.js/dist/umd/popper.js" type="text/javascript" asp-append-version="true"></script>
    @*<script src="~/vendors/general/bootstrap/dist/js/bootstrap.min.js" type="text/javascript" asp-append-version="true"></script>*@
    <script src="~/vendors/general/js-cookie/src/js.cookie.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/moment/min/moment.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/tooltip.js/dist/umd/tooltip.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/perfect-scrollbar/dist/perfect-scrollbar.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/sticky-js/dist/sticky.min.js" type="text/javascript" asp-append-version="true"></script>
    <!--end:: Global Mandatory Vendors -->
    <!--begin:: Global Optional Vendors -->

    <script src="~/vendors/general/jquery-form/dist/jquery.form.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/block-ui/jquery.blockUI.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/js/vendors/bootstrap-datepicker.init.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/bootstrap-datetime-picker/js/bootstrap-datetimepicker.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/bootstrap-timepicker/js/bootstrap-timepicker.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/js/vendors/bootstrap-timepicker.init.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/bootstrap-daterangepicker/daterangepicker.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/bootstrap-select/dist/js/bootstrap-select.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/bootstrap-switch/dist/js/bootstrap-switch.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/js/vendors/bootstrap-switch.init.js" type="text/javascript" asp-append-version="true"></script>
    @*<script src="~/vendors/general/select2/dist/js/select2.full.js" type="text/javascript" asp-append-version="true"></script>*@
    <script src="~/vendors/general/jquery-validation/dist/jquery.validate.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/jquery-validation/dist/additional-methods.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/js/vendors/jquery-validation.init.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/toastr/build/toastr.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/vendors/bootstrap-session-timeout/dist/bootstrap-session-timeout.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/vendors/jquery-idletimer/idle-timer.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/es6-promise-polyfill/promise.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/sweetalert2/dist/sweetalert2.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/js/vendors/sweetalert2.init.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/nouislider/distribute/nouislider.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/general/wnumb/wNumb.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/vendors/custom/fullcalendar/fullcalendar.bundle.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/jquery.showmore.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/jquery-dateformat.min.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/jquery.mask.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/inputmask.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/inputmask.extensions.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/webcam.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/js/fancybox.umd.js" asp-append-version="true"></script>
    <script src="~/js/jquery-idleTimeout.js" asp-append-version="true"></script>
    <script src="~/js/store.min.js" asp-append-version="true"></script>
    <!--end:: Global Optional Vendors -->

    <script src="~/js/helper.js" type="text/javascript" asp-append-version="true"></script>
    @*<script src="~/js/scripts.bundle.js" type="text/javascript" asp-append-version="true"></script>*@
    @*<script src="~/js/mustache.min.js" type="text/javascript" asp-append-version="true"></script>*@

    <!--end::Global Theme Bundle -->
    <!-- MODAL SECTION -->
    @RenderSection("modals", false)

    <div class="ajax-loading"></div>

    @RenderSection("kendoscripts", false)
    @*@Html.Partial("Scripts/_Common")*@
    <partial name="Scripts/_Common" />
    @RenderSection("scripts", required: false)


<script type="text/javascript">
        $(document).ready(function () {
            let idletimeoutlimit = 900; @*'@System.Configuration.ConfigurationManager.AppSettings["IdleTimeoutLimit"]';*@
            let idletimeoutdisplaylimit = 1;@*'@System.Configuration.ConfigurationManager.AppSettings["IdleTimeoutDisplayLimit"]';*@
            $(document).idleTimeout({
                redirectUrl:"@Url.Content("~/core/account/logout")",                        // redirect to this url
                idleTimeLimit: idletimeoutlimit,                                            // separate each event with a space
                dialogDisplayLimit: idletimeoutdisplaylimit,                                // Time to display the warning dialog before logout (and optional callback) in seconds
                sessionKeepAliveTimer: false                                                // Set to false to disable pings.
            });

            $('.change-pw').on('click', function () {
                let $el = $(this),
                    $modal = $.helper.getJqueryObject($el.data("modal")),
                    $form = $modal.find("form");

                $.helper.form.clear($form);
                $modal.modal("show");
            })

            $("#btnSaveChangePW").on('click', function (event) {
                    var $el = $(this),
                        isError = false,
                        $modal = $(this).closest(".modal"),
                        $form = $modal.find("form");

                    var formData = $.helper.form.serializeObject($form);


                    $el.prop("disabled", true);

                    $.postv2("@Url.Content("~/Core/User/ChangePasswordUser")", { user: formData }, function (d) {
                        if (d == "") {
                            $modal.modal("hide");
                            swal("Info", "Success change password", "success");
                        } else {
                            swal("Error", d, "error");
                        }
                    }).fail(function () {
                        swal("Error", "Error when change password", "error");
                    });

                    $el.prop("disabled", false);
                });
        });
        $(function () {
            //console.log("toggle-status ->", localStorage.getItem("toggle"))
            if (localStorage.getItem("toggle") == null) {
                localStorage.setItem("toggle", "open")
                $("#lblSubtitle").show();
            }

            if (localStorage.getItem("toggle") == "close") {
                $("#wrapToggle").addClass("page-sidebar-closed");
                $("#lblSubtitle").hide();
            }

            $('.menu-toggler').on('click', function () {
                if ($("#wrapToggle").hasClass("page-sidebar-closed")) {
                    localStorage.setItem("toggle", "open")
                    $("#lblSubtitle").show();
                }
                else {
                    localStorage.setItem("toggle", "close")
                    $("#lblSubtitle").hide();
                }
            })

            $(document).ajaxStart(function () {
                $("body").addClass("loading");
            }).ajaxStop(function () {
                $("body").removeClass("loading");
            });
        });

        //To get QueryString
        function getParameterByName(name, url = window.location.href) {
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }
</script>
    <script>
        function updateDateTime() {
            var now = new Date();
            var options = { day: 'numeric', month: 'short', year: 'numeric' };
            var formattedDate = now.toLocaleDateString('en-US', options);
            var hours = String(now.getHours()).padStart(2, '0');
            var minutes = String(now.getMinutes()).padStart(2, '0');
            var formattedTime = hours + ":" + minutes;

            document.getElementById('current-date').textContent = formattedDate;
            document.getElementById('current-time').textContent = formattedTime;
        }

        updateDateTime();
        setInterval(updateDateTime, 60000);
    </script>

    <!-- begin::Scrolltop -->
    <!-- end::Scrolltop -->
    @*<script>
            var KTAppOptions = { "colors": { "state": { "brand": "#3d94fb", "light": "#ffffff", "dark": "#282a3c", "primary": "#5867dd", "success": "#34bfa3", "info": "#3d94fb", "warning": "#ffb822", "danger": "#fd27eb" }, "base": { "label": ["#c5cbe3", "#a1a8c3", "#3d4465", "#3e4466"], "shape": ["#f0f3ff", "#d9dffa", "#afb4d4", "#646c9a"] } } };
        </script>*@
</body>
<!-- end::Body -->
</html>
